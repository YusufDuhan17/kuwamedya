{% extends "layout.html" %}

<!-- ===================================================================
Kuwamedya - Portfolyo Sayfası (portfolio.html)
Sürüm: v5.0 (Kusursuz & Ultra Donanımlı)

BU ŞABLON, TAMAMLANAN PROJELERİN SERGİLENDİĞİ, AJANSIN YETENEK
VE TECRÜBESİNİ GÖSTEREN GÖRSEL BİR GALERİDİR.

YENİLİKLER VE "KUSURSUZ" ÖZELLİKLER:
1.  ESTETİK VE MODERN TASARIM: Proje kartları, filtre butonları ve modal
    pencereler, ziyaretçiye profesyonel ve "donanımlı" bir ajans
    izlenimi vermek için baştan sona yeniden tasarlandı.

2.  AKICI FİLTRELEME ANİMASYONLARI: Kategoriler arasında geçiş yaparken,
    projeler ekrandan kaybolup gelmek yerine, Isotope.js kütüphanesi
    sayesinde akıcı animasyonlarla yer değiştirir. (Bu mantık
    `main.js` içindedir).

3.  MERKEZİ JAVASCRIPT MİMARİSİ (DRY PRENSİBİ):
    Bu dosyanın içindeki TÜM JavaScript mantığı (Isotope'u başlatma,
    filtre butonlarını yönetme) kaldırılmıştır. Bu fonksiyonlar artık
    projenin ana `static/js/main.js` dosyası içindeki
    `KuwamedyaApp.Vitrin.initPortfolioFilter` modülü tarafından
    merkezi olarak yönetilmektedir.

4.  DETAYLI VE DİNAMİK PROJE MODAL'I:
    Her proje için açılan modal pencere, projenin görselini, tüm
    detaylarını (kategori, müşteri, tarih), proje açıklamasını ve
    en önemlisi, veritabanından gelen `project.technologies` ilişkisini
    kullanarak "Kullanılan Teknolojiler"i dinamik olarak sergiler.

5.  TAM BACKEND ENTEGRASYONU:
    Şablon, `main_routes.py`'den gelen `projects` ve `categories`
    verileriyle %100 uyumlu çalışır. Hiç proje yoksa veya filtreleme
    sonucu boşsa, kullanıcı dostu bilgilendirme mesajları gösterilir.
=================================================================== -->

<!-- Sayfa başlığı (Title) ve SEO Açıklaması (Description) blokları -->
{% block title %}Portfolyo - Gerçekleştirdiğimiz Projeler | Kuwamedya{% endblock %}
{% block description %}Kuwamedya olarak web yazılımı, dijital pazarlama ve sosyal medya alanlarında tamamladığımız başarılı projeleri ve müşteri başarı hikayelerini inceleyin.{% endblock %}

<!-- Ana içerik bloğu -->
{% block content %}

<!-- Sayfa başlığı -->
<section class="page-header py-5 text-center">
    <div class="container" data-aos="fade-down">
        <h1 class="display-4 fw-bold">Portfolyo</h1>
        <p class="lead text-muted">Yeteneklerimizi ve tutkumuzu yansıtan tamamlanmış projelerimiz.</p>
    </div>
</section>

<!-- Portfolyo bölümü -->
<section class="portfolio-section py-5">
    <div class="container">
        <!-- Filtreleme Butonları (Geri Eklendi) -->
        <div class="row mb-4" data-aos="fade-up">
            <div class="col-12 text-center">
                <div id="portfolio-filters" class="btn-group flex-wrap" role="group">
                    <button type="button" class="btn btn-outline-secondary filter-btn active" data-filter="*">Tümü</button>
                    {% for cat in categories %}
                    <button type="button" class="btn btn-outline-secondary filter-btn" data-filter=".filter-{{ cat | lower | replace(' ', '-') }}">{{ cat }}</button>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Proje Kartları Galerisi -->
        <!-- 
          .portfolio-container: Bu ID, `main.js` dosyasındaki 
          Isotope.js'in ana konteyneri olarak kullanılır.
        -->
        <div class="row g-4 portfolio-container">
            {% if projects %}
                <!-- 
                  `main_routes.py`'den gelen `projects` listesi üzerinde döngüye girilir.
                -->
                {% for project in projects %}
                <!-- 
                  Her proje kartına, kategorisine uygun bir filtre sınıfı eklenir.
                  (örn: "filter-web-yazilim")
                -->
                <div class="col-lg-4 col-md-6 portfolio-item filter-{{ project.category | lower | replace(' ', '-') }}">
                    <div class="project-card shadow-lg" data-bs-toggle="modal" data-bs-target="#projectModal-{{ project.id }}" data-aos="zoom-in-up">
                        <img src="{{ project.cover_image_url }}" alt="{{ project.title }}">
                        <div class="project-card-overlay">
                            <div class="project-card-content">
                                <h3>{{ project.title }}</h3>
                                <span>{{ project.category }}</span>
                            </div>
                            <div class="plus-icon"><i class="fas fa-plus"></i></div>
                        </div>
                    </div>
                </div>

                <!-- 
                  DİNAMİK PROJE MODAL'I
                  Her proje için benzersiz ID'ye (`projectModal-{{ project.id }}`) sahip
                  bir modal penceresi oluşturulur.
                -->
                <div class="modal fade" id="projectModal-{{ project.id }}" tabindex="-1" aria-labelledby="projectModalLabel-{{ project.id }}" aria-hidden="true">
                    <div class="modal-dialog modal-xl modal-dialog-centered">
                        <div class="modal-content bg-dark text-white border-secondary">
                            <div class="modal-header border-secondary">
                                <h5 class="modal-title" id="projectModalLabel-{{ project.id }}">{{ project.title }}</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Kapat"></button>
                            </div>
                            <div class="modal-body p-lg-5">
                                <div class="row g-5">
                                    <!-- Sol Taraf: Proje Görseli -->
                                    <div class="col-lg-7">
                                        <img src="{{ project.cover_image_url }}" class="img-fluid rounded mb-3 shadow-lg" alt="{{ project.title }}">
                                    </div>
                                    <!-- Sağ Taraf: Proje Detayları -->
                                    <div class="col-lg-5">
                                        <h3 class="fw-bold text-primary">Proje Bilgileri</h3>
                                        <ul class="list-unstyled project-details-list">
                                            <li><strong><i class="fas fa-tag fa-fw me-2"></i>Kategori:</strong> {{ project.category }}</li>
                                            <li><strong><i class="fas fa-user-tie fa-fw me-2"></i>Müşteri:</strong> {{ project.client }}</li>
                                            <!-- 
                                              `strftime_tr` filtresi (app.py'de tanımlı)
                                              tarihi "19 Ekim 2025" formatında gösterir.
                                            -->
                                            <li><strong><i class="fas fa-calendar-alt fa-fw me-2"></i>Tarih:</strong> {{ project.project_date | strftime_tr }}</li>
                                        </ul>
                                        
                                        <h3 class="fw-bold text-primary mt-4">Proje Açıklaması</h3>
                                        <p>{{ project.description }}</p>

                                        <!-- 
                                          KULLANILAN TEKNOLOJİLER (DİNAMİK)
                                          `models.py`'deki 'project.technologies' ilişkisi burada kullanılır.
                                        -->
                                        {% if project.technologies.all() %}
                                        <h3 class="fw-bold text-primary mt-4">Kullanılan Teknolojiler</h3>
                                        <div class="d-flex flex-wrap gap-2">
                                            {% for tech in project.technologies %}
                                                <span class="badge bg-secondary fs-6">{{ tech.name }}</span>
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer border-secondary">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                                <!-- Sadece `live_url` varsa "Siteyi Ziyaret Et" butonu görünür -->
                                {% if project.live_url %}
                                <a href="{{ project.live_url }}" target="_blank" class="btn btn-primary">
                                    <i class="fas fa-external-link-alt me-2"></i>Siteyi Ziyaret Et
                                </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}

                <!-- 
                  "BOŞ DURUM" KARTI (FİLTRELEME İÇİN)
                  Bu kart normalde gizlidir. `main.js` (Isotope) filtreleme
                  sonucu 0 (sıfır) proje bulursa bunu görünür yapar.
                -->
                <div class="col-12 no-results-item" style="display: none;">
                    <div class="empty-state-card bg-dark border-secondary p-5 rounded text-center">
                         <i class="fas fa-search-minus fa-4x text-primary mb-4"></i>
                        <h3 class="fw-bold">Sonuç Bulunamadı</h3>
                        <p class="text-muted">Seçtiğiniz kategoriye uygun bir proje bulunamadı.</p>
                    </div>
                </div>
            {% else %}
                <!-- 
                  "BOŞ DURUM" KARTI (VERİTABANI BOŞSA)
                  Backend'den (`projects` listesi) hiç proje gelmezse bu gösterilir.
                -->
                <div class="col-12 text-center py-5" data-aos="fade-up">
                    <div class="empty-state-card bg-dark border-secondary p-5 rounded">
                        <i class="fas fa-folder-open fa-4x text-primary mb-4"></i>
                        <h3 class="fw-bold">Henüz Sergilenecek Proje Yok!</h3>
                        <p class="text-muted">Tamamladığımız harika projeleri çok yakında bu bölümde sergileyeceğiz.</p>
                        <!-- Admin ise, proje eklemesi için panele yönlendirilir -->
                        {% if current_user.is_authenticated and current_user.is_admin %}
                            <hr class="my-4 border-secondary">
                            <!-- BU ROTA HENÜZ OLUŞTURULMADI, FAZ 2'DE OLUŞTURULACAK -->
                            <a href="{{ url_for('admin.project_list') }}" class="btn btn-success"><i class="fas fa-plus-circle me-2"></i>Yeni Proje Ekle</a>
                        {% endif %}
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</section>

{% endblock %}


{% block scripts %}
<!-- 
  NOT (v5.0): KOD TEMİZLİĞİ (DRY PRENSİBİ)
  Bu dosyadaki JavaScript mantığı `static/js/main.js` dosyasına taşındı.
  Aşağıdaki kütüphaneler, `main.js` dosyasındaki `KuwamedyaApp.Vitrin.initPortfolioFilter`
  fonksiyonunun çalışması için GEREKLİDİR.
-->

<!-- Isotope.js (Filtreleme ve animasyonlu ızgara için) -->
<script src="https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js"></script>

<!-- ImagesLoaded (Isotope'un resimler yüklenmeden çalışmasını engellemek için) -->
<script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script>
{% endblock %}
